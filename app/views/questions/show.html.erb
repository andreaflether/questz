<div class="row mt-4">
  <div class="col-md-9">
    <div class="card question" id="question_<%= @question.id %>">
      <div class="card-header mt-2 bg-white">
        <p class="text-orange fw-bold mb-2">
          <%= raw status_to_html(@question.status) %>
        </p>
        <div class="d-flex mb-2">
          <%= link_to profile_path(@question.user), class: 'mb-auto' do %>
            <% if @question.user.avatar? %>
              <%= image_tag(@question.user.avatar_url, 
                class: 'rounded-circle user-avatar-50 me-2') %>
            <% else %>
              <%= image_tag 'no-avatar.png',
              class: 'rounded-circle user-avatar-50 me-2 border' %>
            <% end %> 
          <% end %>
          <div class="d-flex flex-column">
            <div class="card-title">
              <h4 class="question-title-show text-break mb-1"><%= @question.title %></h4>
            </div>
            <p class="text-muted mb-0 question-info">
              Asked by 
              <%= link_to @question.user.name, profile_path(@question.user), class: 'fw-bold' %>
              
              <span class="question-date">
                on <b><%= format_datetime(@question.created_at) %></b>
                (<%= time_ago_in_words(@question.created_at) %> ago)
              </span>
              &nbsp;Â·&nbsp;
              <span>Viewed <%= pluralize(@question.impressions_count, 'time') %></span>
            </p>
          </div>
        </div>
      </div>
      <div class="card-body">
        <div class="d-flex">
          <div class="d-flex flex-column question-votes text-muted mt-1" 
            data-user-vote=<%= user_vote(@question) %> id="question_<%= @question.id %>_votes">
            <%= link_to upvote_question_path(@question),
              method: :patch,
              remote: true,
              class: 'text-muted vote-up' do %>
              <i class="fas fa-caret-up"></i>
            <% end %>

            <span class="question-vote-up fs-5"><%= @question.weighted_score %></span>

            <%= link_to downvote_question_path(@question),
              method: :patch,
              remote: true,
              class: 'text-muted vote-down mt-1' do %>
              <i class="fas fa-caret-down"></i>
            <% end %>
          </div>
          <div class="d-flex flex-column flex-fill ms-4">
            <div class="question-body trix-content">
              <%= sanitize @question.body %>
            </div>
            <div class="tags mt-2">
              <% @question.tags.each do |tag| %>
                <%= link_to tag_in_questions_path(tag) do %>
                  <span class="badge question-tag mt-1"><%= tag.name %></span>
                <% end %>
              <% end %>
            </div>
            <div class="question-actions small text-muted mt-3">
            <span class="share">
              <i class="fas fa-share-square"></i>&nbsp;Share
            </span>
            <% if can? :update, @question %>
              <span class="edit">
                <%= link_to edit_question_path(@question), class: 'text-muted' do %>
                  <i class="fas fa-edit"></i>&nbsp;Edit
                <% end %> 
              </span>
            <% end %>
            <span class="report">
              <i class="far fa-flag"></i>&nbsp;Report
            </span>
            </div>
          </div>
        </div>
      </div>
      <ul class="list-group list-group-flush bg-light">
        <h5 class="mt-3 ms-3"><%= pluralize(@question.answers_count, 'answer') %> </h5>
        <%= render @question.answers.includes([:user]) %>
      </ul>
      <div class="card-footer d-flex flex-column text-dark">
        <div class="new-user-comment w-100 d-inline-flex align-items-center">
          <% if current_user.avatar? %>
            <%= image_tag(current_user.avatar_url, 
              class: 'img-fluid rounded-circle user-avatar-45 me-2',
              id: 'user-avatar') %>
          <% else %>
            <%= image_tag 'http://paroquiasagradomerces.com.br/wp-content/uploads/2018/02/no-avatar.png',
            class: 'img-fluid rounded-circle user-avatar-45 me-2', 
            id: 'user-avatar' %>
          <% end %> 
          
          <div class="input-group">
            <input class="form-control my-2" placeholder="Type your answer here"></input>
            <%= link_to 'Post', '', class: 'btn btn-orange my-auto'%>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card">
      <div class="card-header bg-white">
        <h6 class="card-title my-2">Related questions</h6>
      </div>
      <% if @related_questions.any? %>
        <ul class="list-group list-group-flush">
          <%= render partial: 'related_questions', collection: @related_questions, as: :question %>
        </ul>
      <% else %>
        <div class="card-body">
          <p class="mb-1">No questions to display just yet.</p>
          <%= link_to 'Ask a new one', new_question_path, class: 'fw-bold' %>
        </div>
      <% end %>
    </div>
  </div>
</div>
